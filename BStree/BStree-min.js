class BStree{constructor(){this.h=0;this.length=0}add(n){if(this.h){let t;if(n>this.r)t=this.l.add(n);else if(n<this.r)t=this.s.add(n);else return!1;return this.set(),t}return this.r=n,this.h=1,this.length=1,this.s=new BStree,this.l=new BStree,!0}getnth(n){if(this.h){let t=this.s.length;return n==t?this.r:n>t?this.l.getnth(s-t-1):this.s.getnth(n)}}indexOf(n){return this.h?n==this.r?this.s.length:n<this.r?this.s.indexOf(n):n>this.r?this.s.length+1+this.l.indexOf(n):-1:-1}delete(n){if(this.h)if(this.r==n){if(this.h==1)return delete this.r,delete this.l,delete this.s,this.h=0,this.length=0,!0;if(this.l.h){let n=this.l.getnth(0);return this.l.delete(n),this.r=n,this.set(),!0}this.r=this.s.r;this.h=1;this.length=1;this.s=new BStree}else(n>this.r?this.l:this.s).delete(n)&&this.set();else return!1}set(){if(this.h){let n=this.l.h-this.s.h;if(Math.abs(n)==2){let t=new BStree,i=new BStree;n==2?(i.s=this.s,i.r=this.r,this.l.s.h>this.l.l.h?(i.l=this.l.s.s,t.l=this.l.l,t.r=this.l.r,t.s=this.l.s.l,this.r=this.l.s.r):(i.l=this.l.s,t=this.l.l,this.r=this.l.r)):(t.l=this.l,t.r=this.r,this.s.l.h>this.s.s.h?(t.s=this.s.l.l,i.s=this.s.s,i.r=this.s.r,i.l=this.s.l.s,this.r=this.s.l.r):(t.s=this.s.l,i=this.s.s,this.r=this.s.r));i.h=Math.max(i.l.h,i.s.h)+1;i.length=i.l.length+i.s.length+1;t.h=Math.max(t.l.h,t.s.h)+1;t.length=t.l.length+t.s.length+1;this.s=i;this.l=t}this.h=Math.max(this.l.h,this.s.h)+1;this.length=this.l.length+this.s.length+1}}}
